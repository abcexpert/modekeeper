# Архитектура

ModeKeeper — локальная, self-serve система наблюдения и безопасного автотюнинга ML-нагрузок. Проект оформлен как installable package с CLI.

## Компоненты
- `core`: паспорт режима, state machine, детекторы drift/burst/stragglers.
- `telemetry`: источники и сбор телеметрии (логи, метрики, синтетика для демо).
- `actuators`: параметры («ручки») с ограничениями и валидаторами.
- `policy`: правила и «аккорды» (координированные действия над 2–3 ручками).
- `safety`: лимит скорости изменений, kill-switch, rollback, allowlist ручек, explain-log.
- `adapters`: интеграции (MVP PyTorch Lightning callback).

## Поток данных
1. Сборщики телеметрии выдают временные ряды.
2. `core` вычисляет сигналы drift/burst/stragglers.
3. `policy` формирует предложения действий и/или аккордов.
4. `safety` применяет guardrails, фиксирует explain-log, решает apply или dry-run.
5. `actuators` выполняют изменения параметров (или имитируют их).

## Границы модулей
- `core` не применяет изменения — только анализирует и предлагает.
- `safety` — единственная точка принятия решения о применении.
- `actuators` инкапсулируют реальные параметры и их ограничения.
- `policy` — чистая детерминированная логика.

## CLI
- `mk observe`: запуск OBSERVE_ONLY и генерация отчета.
- `mk closed-loop`: оценка policy и (опционально) применение действий.
- `mk demo`: синтетические сценарии.
